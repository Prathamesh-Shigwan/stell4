{% extends "custom_admin/base_site.html" %}

{% block content %}
<style>
    .form-group label.required::after {
        content: " *";
        color: red;
    }
    .form-control.is-invalid, .form-check-input.is-invalid {
        border-color: #dc3545 !important;
    }
    .invalid-feedback.d-block {
        display: block !important;
        color: #dc3545;
        font-size: 0.875em;
    }
    .form-control {
        display: block;
        width: 100%;
        padding: .375rem .75rem;
        font-size: 1rem;
        line-height: 1.5;
        color: #495057;
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: .25rem;
    }
    .file-upload-label {
        display: inline-block;
        padding: 8px 16px;
        border: 1px solid #007bff;
        border-radius: 4px;
        background-color: #007bff;
        color: white;
        cursor: pointer;
    }
    .file-upload-label:hover {
        background-color: #0056b3;
    }
    input[type="file"] {
        display: none;
    }
    .form-check {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .form-check-input {
        width: 1.25em;
        height: 1.25em;
    }
</style>

<div class="container mt-4" style="background-color: #f8f9fa; padding: 20px; border-radius: 8px;">
    <h2 class="mb-3" style="text-align: center; font-weight: 600;">{{ title }}</h2>

    <form method="POST" enctype="multipart/form-data" id="brandForm" style="max-width: 500px; margin: 0 auto; border: 1px solid #dee2e6; padding: 25px; border-radius: 8px;">
        {% csrf_token %}

        <div class="form-group mb-3">
            <label for="{{ form.name.id_for_label }}" class="required" style="font-weight: bold; margin-bottom: 5px;">Brand Name</label>
            {{ form.name }}
            {% if form.name.errors %}<div class="invalid-feedback d-block">{{ form.name.errors }}</div>{% endif %}
        </div>

        <div class="form-group mb-3">
            <label class="required" style="font-weight: bold; margin-bottom: 5px;">Brand Logo</label>

            {{ form.image }}

            <label for="{{ form.image.id_for_label }}" class="file-upload-label" style="margin-top: 5px;">
                Choose New Image
            </label>

            <div id="file-name" style="margin-top: 8px; font-style: italic;">No new file chosen</div>

            {% if form.image.errors %}<div class="invalid-feedback d-block">{{ form.image.errors }}</div>{% endif %}
        </div>

        <div class="form-group mb-3">
            <div class="form-check">
                {{ form.is_active }}
                <label for="{{ form.is_active.id_for_label }}" class="form-check-label" style="font-weight: bold;">Is Active</label>
            </div>
             {% if form.is_active.errors %}<div class="invalid-feedback d-block">{{ form.is_active.errors }}</div>{% endif %}
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 25px;">
            <button type="submit" class="btn btn-success" style="font-weight: bold; padding: 10px 20px;">
                {% if form.instance.pk %}Update Brand{% else %}Add Brand{% endif %}
            </button>
            <a href="{% url 'custom_admin:brand_list' %}" class="btn btn-secondary" style="font-weight: bold; padding: 10px 20px;">
                Cancel
            </a>
        </div>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const fileInput = document.getElementById('{{ form.image.id_for_label }}');
        const fileNameDisplay = document.getElementById('file-name');

        if (fileInput) {
            fileInput.addEventListener('change', function() {
                if (this.files && this.files.length > 0) {
                    fileNameDisplay.textContent = this.files[0].name;
                } else {
                    fileNameDisplay.textContent = 'No new file chosen';
                }
            });
        }
    });
</script>
{% endblock %}